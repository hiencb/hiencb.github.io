{"version":3,"sources":["main.min.js"],"names":[],"mappings":"AAAA","file":"main.min.js","sourcesContent":["'use strict';\n\n// ReSharper disable UndeclaredGlobalVariableUsing\n\n(function () {\n  'use strict';\n\n  angular.module('mainApp', ['ngRoute', 'ngAnimate', 'angular-loading-bar', 'dataView']);\n})();\n// ReSharper disable UndeclaredGlobalVariableUsing\n(function () {\n  'use strict';\n\n  angular.module('mainApp').directive('cbBreadcrumb', breadcrumbDirective);\n\n  breadcrumbDirective.$inject = [];\n  function breadcrumbDirective() {\n    var template = '\\n<ol class=\"breadcrumb\">\\n  <li ng-repeat=\"nav in data.navs\">\\n    <a ng-href=\"{{nav.path}}\">{{nav.name}}</a>\\n  </li>\\n  <li class=\"active\">{{data.current}}</li>\\n</ol>';\n\n    return {\n      replace: true,\n      scope: { data: '<' },\n      template: template\n    };\n  }\n})();\n// ReSharper disable UndeclaredGlobalVariableUsing\n(function () {\n  'use strict';\n\n  angular.module('mainApp').config(config);\n\n  config.$inject = ['$locationProvider', 'dataViewServiceProvider', 'apiUrl', 'commonFn'];\n  function config(locPrd, dvsPrd, apiUrl, commonFn) {\n    locPrd.html5Mode(true);\n\n    dvsPrd.className('object-list', 'unstyled');\n    dvsPrd.className('panel-item', 'panel');\n    dvsPrd.linkChecker(checkLink);\n    dvsPrd.linkGetter(getLink);\n    dvsPrd.linkObjectGetter(getLinkObject);\n    dvsPrd.normalizer(commonFn.normalize);\n\n    function checkLink(o) {\n      return commonFn.isUrl(o) || commonFn.isUrl(o.url);\n    }\n\n    function getLink(o) {\n      var rawLink = commonFn.isUrl(o) && o || commonFn.isUrl(o.url) && o.url;\n      return getApiPath(rawLink);\n    }\n\n    function getLinkObject(o) {\n      if (angular.isString(o)) return getPathName(o);\n      if (angular.isObject(o)) {\n        if (Object.keys(o) && o.name && o.url) return o.name;\n\n        var res = angular.copy(o);\n        var url = o.url;\n        delete res.url;\n        return Object.keys(res).length ? res : getPathName(url);\n      }\n      return null;\n    }\n\n    function getApiPath(url) {\n      return commonFn.getRelativePath(url, apiUrl);\n    }\n\n    function getPathName(url) {\n      return !isApiUrl(url) ? url : commonFn.getPathName(getApiPath(url));\n    }\n\n    function isApiUrl(data) {\n      return typeof data === \"string\" && commonFn.isSubPath(data, apiUrl);\n    }\n  }\n})();\n// ReSharper disable UndeclaredGlobalVariableUsing\n(function () {\n  'use strict';\n\n  var commonFn = {\n    extractPaths: extractPaths,\n    getAbsolutePath: getAbsolutePath,\n    getPathName: getPathName,\n    getRelativePath: getRelativePath,\n    isSubPath: isSubPath,\n    isUrl: isUrl,\n    joinPaths: joinPaths,\n    normalize: normalize,\n    normalizePath: normalizePath,\n    pathsEqual: pathsEqual,\n    removeLeadingSlash: removeLeadingSlash,\n    removeTrailingSlash: removeTrailingSlash\n  };\n\n  angular.module('mainApp').constant('apiUrl', 'http://pokeapi.co/api/v2').constant('pokeServiceUrl', 'https://pokeservice.herokuapp.com/').constant('themesUrl', 'public/resources/data/themes.json').constant('commonFn', commonFn);\n\n  function normalize(value) {\n    return value === null || value === undefined ? '' : _.startCase(value.toString());\n  }\n\n  function getAbsolutePath(relativePath, base) {\n    return joinPaths(base, relativePath);\n  }\n\n  function getRelativePath(path, base) {\n    return isSubPath(path, base) ? path.substring(base.length) : path;\n  }\n\n  function getPathName(url) {\n    var paths = extractPaths(url);\n    return paths.length <= 1 ? paths[0] : paths[paths.length - 2] + '/' + paths[paths.length - 1];\n  }\n\n  function pathsEqual(path1, path2) {\n    return normalize(path1) === normalize(path2);\n  }\n\n  function joinPaths() {\n    for (var _len = arguments.length, parts = Array(_len), _key = 0; _key < _len; _key++) {\n      parts[_key] = arguments[_key];\n    }\n\n    return parts.reduce(function (acc, cur) {\n      return removeTrailingSlash(acc) + '/' + removeLeadingSlash(cur);\n    }, '');\n  }\n\n  function isSubPath(path, base) {\n    return path.indexOf(base) === 0;\n  }\n\n  function isUrl(text) {\n    return typeof text === \"string\" && /https?:\\/\\//.test(text);\n  }\n\n  function removeLeadingSlash(path) {\n    return path.match(/^\\/?(.*)/)[1];\n  }\n\n  function removeTrailingSlash(path) {\n    return path.match(/(.*?)\\/?$/)[1];\n  }\n\n  function normalizePath(path) {\n    return removeLeadingSlash(removeTrailingSlash(path)).toLowerCase();\n  }\n\n  function extractPaths(path) {\n    return path.match(/[^\\/]+/g) || path;\n  }\n})();\n// ReSharper disable UndeclaredGlobalVariableUsing\n(function () {\n  'use strict';\n\n  angular.module('mainApp').controller('mainController', MainController);\n\n  MainController.$inject = ['$scope', '$location', '$log', '$http', 'pokeService', 'themesService'];\n  function MainController($scope, $location, $log, $http, pokeService, themesService) {\n    var vm = this;\n    vm.title = 'PokéCOOL';\n    vm.subtitle = 'A pokémon encyclopedia - Everything you want to know about Pokémon';\n    vm.mainPages = {\n      'Home': '/',\n      'Contact': '/contact',\n      'About': '/about'\n    };\n    vm.debug = { shown: false };\n    vm.selectedTheme = {};\n    vm.categories = {};\n    vm.activeClass = activeClass;\n    activate();\n\n    $scope.$on('$locationChangeSuccess', function () {\n      getData();\n    });\n\n    function activate() {\n      themesService.getThemes().then(function (themes) {\n        vm.themes = themes;\n        vm.selectedTheme = themes[0];\n      });\n\n      pokeService.getCategories().then(function (categories) {\n        return vm.categories = categories;\n      }).catch(function (error) {\n        return vm.error = error;\n      });\n    }\n\n    function getData() {\n      pokeService.getData($location.url()).then(function (res) {\n        vm.data = res.data;\n        vm.pageName = res.name;\n        vm.breadcrumb = res.navInfo;\n      }).catch(function (error) {\n        return vm.error = error;\n      });\n    }\n\n    function activeClass(path) {\n      return path === $location.url() ? 'active' : '';\n    }\n  }\n})();\n\n// TODO: handle ajax errors\n// ReSharper disable UndeclaredGlobalVariableUsing\n(function () {\n  'use strict';\n\n  angular.module('mainApp').factory('pokeService', pokeService);\n\n  pokeService.$inject = ['$q', '$http', 'apiUrl', 'pokeServiceUrl', 'commonFn'];\n  function pokeService($q, $http, apiUrl, pokeServiceUrl, commonFn) {\n    var cache = { data: {}, categories: null };\n\n    return {\n      getData: getData,\n      getCategories: getCategories\n    };\n\n    function getData() {\n      var path = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '/';\n\n      var url = commonFn.normalizePath(commonFn.getAbsolutePath(path, pokeServiceUrl));\n      var cachedData = cache.data[url];\n      if (cachedData) return $q.when(cachedData);\n\n      return $http.get(url).then(function (res) {\n        var data = createPageData(res.data, url);\n        cache.data[url] = data;\n        return data;\n      });\n    }\n\n    function getCategories() {\n      var cachedCategories = cache.categories;\n      if (cachedCategories) return $q.when(cachedCategories);\n      return getData().then(function (res) {\n        var categories = createCategoryData(res.data);\n        cache.categories = categories;\n        return categories;\n      });\n    }\n\n    function createPageData(data, url) {\n      var res = {\n        name: '',\n        data: data,\n        navInfo: {\n          current: '',\n          navs: []\n        }\n      };\n\n      if (commonFn.pathsEqual(url, pokeServiceUrl)) {\n        res.navInfo.current = 'Home';\n        res.name = 'Categories';\n        return res;\n      }\n\n      var relativePath = commonFn.getRelativePath(url, pokeServiceUrl);\n      var rawName = data.name || commonFn.getPathName(relativePath);\n      res.name = res.navInfo.current = commonFn.normalize(rawName);\n      res.navInfo.navs.push({ name: 'Home', path: '/' });\n\n      var paths = commonFn.extractPaths(relativePath);\n      if (!paths) return res;\n\n      for (var i = 0; i < paths.length - 1; i++) {\n        var p = paths[i];\n        var parentPath = res.navInfo.navs[res.navInfo.navs.length - 1].path;\n        var path = commonFn.joinPaths(parentPath, p);\n        var name = commonFn.normalize(p);\n        res.navInfo.navs.push({ name: name, path: path });\n      }\n\n      return res;\n    }\n\n    function createCategoryData(data) {\n      return Object.keys(data).map(function (k) {\n        return {\n          name: commonFn.normalize(k),\n          path: commonFn.getRelativePath(data[k], apiUrl)\n        };\n      });\n    }\n  }\n})();\n// ReSharper disable UndeclaredGlobalVariableUsing\n(function () {\n  'use strict';\n\n  angular.module('mainApp').factory('themesService', themesService);\n\n  themesService.$inject = ['$http', 'themesUrl'];\n  function themesService($http, themesUrl) {\n    return { getThemes: getThemes };\n\n    function getThemes() {\n      return $http.get(themesUrl).then(function (res) {\n        return res.data;\n      });\n    }\n  }\n})();"]}